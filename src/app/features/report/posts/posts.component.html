<div class="row">
  <div class="col-lg-2 col-12 mb-lg-0 mb-2">
    <div class="card rounded-0 hidden-scroll" style="height: 76vh">
      <div class="card-header bg-transparent d-flex align-items-center flex-row">
        <div>
          <a class="btn btn-outline-primary me-1" [routerLink]="['/report', 'post', 'new']">
            <fa-icon [icon]="['fas', 'plus']"></fa-icon>
          </a>
        </div>

        <input
          type="search"
          [(ngModel)]="searchInput"
          (ngModelChange)="search(null)"
          placeholder="Search"
          aria-label="Search"
          class="form-control no-focus"
        />
      </div>
      <ul class="list-group">
        <li class="list-group-item border-0 border-bottom rounded-0" *ngIf="tags">
          <label class="fw-bold mt-1">Filter by tag</label>
          <div class="d-block mt-1 mb-1">
            <span
              role="button"
              class="badge p-1 fs-6 rounded-0 mt-1 me-1 mb-1"
              (click)="search(t)"
              [class.bg-success]="selectedTag !== t"
              [class.bg-warning]="selectedTag === t"
              *ngFor="let t of tags"
              >#{{ t }}</span
            >
          </div>
        </li>
        <li class="list-group-item border-0 border-bottom rounded-0">
          <label class="fw-bold mt-1">Filter by priority</label>

          <select
            [disabled]="disablePriorityFilter"
            [(ngModel)]="priorityFilter"
            (ngModelChange)="search(null)"
            class="form-control no-focus mb-2"
            aria-label="Filter by priority"
          >
            <option [ngValue]="null" selected>--- Select ---</option>
            <option value="LOW">ğŸ”µ Low</option>
            <option value="MEDIUM">ğŸŸ¡ Medium</option>
            <option value="HIGH">ğŸŸ  High</option>
            <option value="URGENT">ğŸ”´ Urgent</option>
          </select>
        </li>
        <li class="list-group-item border-0 border-bottom rounded-0">
          <label class="fw-bold mt-1">Filter by status</label>
          <select
            [disabled]="disableStatusFilter"
            [(ngModel)]="statusFilter"
            (ngModelChange)="search(null)"
            class="form-control no-focus"
            aria-label="Filter by status"
          >
            <option [ngValue]="null" selected>--- Select ---</option>
            <option value="DRAFT">ğŸ“ Draft</option>
            <option value="IN_PROGRESS">â³ In progress</option>
            <option value="PENDING">ğŸ•— Pending</option>
            <option value="DONE">âœ… Done</option>
            <option value="CANCELLED">âŒ Cancelled</option>
          </select>
        </li>
      </ul>
    </div>
  </div>

  <div class="col-lg-10 col-12">
    <ng-container *ngIf="!posts?.content?.length">
      <p>No content</p>
    </ng-container>
    <ng-container *ngIf="posts && posts.page.size > 0">
      <div class="table-responsive hidden-scroll" style="height: 73vh">
        <table class="table table-bordered table-sm">
          <tbody>
            <tr *ngFor="let n of posts.content">
              <td class="fit">
                <div class="d-inline-block">
                  <a
                    class="btn btn-link p-1"
                    (click)="$event.preventDefault(); toggleBookmark($event, n)"
                    [class.text-muted]="!n.bookmarked"
                    [class.text-warning]="n.bookmarked"
                    ><fa-icon [icon]="['fas', 'star']"
                  /></a>
                  <button
                    class="btn btn-link text-dark text-decoration-none p-1"
                    [routerLink]="['/report', 'post', slugify(n.title), n.id]"
                  >
                    <fa-icon [icon]="['fas', 'book-open']"></fa-icon>
                  </button>
                  <button
                    class="btn btn-link text-dark text-decoration-none p-1"
                    [routerLink]="['/report', 'post', slugify(n.title), n.id, 'edit']"
                  >
                    <fa-icon [icon]="['fas', 'edit']"></fa-icon>
                  </button>
                  <button class="btn btn-link text-dark text-decoration-none p-1" (click)="delete(n)">
                    <fa-icon [icon]="['fas', 'trash']"></fa-icon>
                  </button>
                </div>
              </td>
              <td class="text-break">
                <div class="d-flex justify-content-between">
                  <a
                    class="btn btn-link text-decoration-none fw-bold p-0 m-0"
                    [routerLink]="['/report', 'post', slugify(n.title), n.id]"
                  >
                    <span class="me-1" *ngIf="n.priority === 'LOW'">ğŸ”µ</span>
                    <span class="me-1" *ngIf="n.priority === 'MEDIUM'">ğŸŸ¡</span>
                    <span class="me-1" *ngIf="n.priority === 'HIGH'">ğŸŸ </span>
                    <span class="me-1" *ngIf="n.priority === 'URGENT'">ğŸ”´</span>
                    <span class="me-1" *ngIf="n.status === 'DRAFT'"> ğŸ“</span>
                    <span class="me-1" *ngIf="n.status === 'IN_PROGRESS'"> â³</span>
                    <span class="me-1" *ngIf="n.status === 'PENDING'"> ğŸ•—</span>
                    <span class="me-1" *ngIf="n.status === 'DONE'"> âœ…</span>
                    <span class="me-1" *ngIf="n.status === 'CANCELLED'"> âŒ</span>
                    {{ n.title | titlecase }}</a
                  >

                  <small class="text-muted">{{ n.updatedDate | date: 'dd/MM/yyyy' }}</small>
                </div>

                <p class="mt-2 bg-light p-1 text-ws-break">
                  <i>{{ n.description }}</i>
                </p>
                <small class="text-muted">{{ getDueDateStatusLine(n.status, n.dueDate) }}</small>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="d-flex justify-content-end mt-1">
        <ngb-pagination
          *ngIf="posts && posts.page.totalPages > 1"
          [page]="pageNumber"
          [pageSize]="posts.page.size"
          [maxSize]="5"
          [collectionSize]="posts.page.totalElements"
          (pageChange)="load($event)"
        ></ngb-pagination>
      </div>
    </ng-container>

    <ng-container *ngIf="!posts || posts.page.size === 0"><span class="mt-2 mb-2">No content.</span></ng-container>
  </div>
</div>

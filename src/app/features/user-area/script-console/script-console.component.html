<div class="ps-2 pe-2">
  <ng-container *ngIf="initialized">
    <div class="row">
      <div class="col-lg-10 col-12 mb-3">
        <div class="d-flex mb-2 align-items-center">
          <div class="me-1">
            <app-graaljs-help-modal />
          </div>
          <select class="form-select me-2" [formControl]="formUserScript" (change)="selectScript()">
            <option [ngValue]="null">--- Select ---</option>
            <option *ngFor="let s of userScripts" [ngValue]="s">{{ 'Script ' + s.id }}</option>
          </select>
          <button
            class="btn btn-outline-success me-1"
            [disabled]="!formScript?.value?.trim()?.length"
            (click)="saveScript()"
          >
            Save
          </button>
          <button class="btn btn-outline-danger" [disabled]="!formUserScript?.value" (click)="deleteScript()">
            Delete
          </button>
        </div>
        <div class="card border-1">
          <div class="card-header bg-transparent text-dark">
            <h5 class="mb-0">Console</h5>
          </div>
          <div class="card-body bg-transparent text-dark">
            <div class="mb-3 mt-2">
              <textarea
                autofocus
                appAutoFocus
                [formControl]="formScript"
                class="form-control bg-transparent text-dark resize-none"
                [rows]="15"
                [placeholder]="placeholder"
              >
              </textarea>
            </div>

            <div class="d-flex justify-content-center mb-3">
              <button class="btn btn-outline-primary me-2" (click)="run()">Run</button>
              <app-copy-to-clipboard [textToCopy]="out" [btnClasses]="'btn btn-outline-secondary'">
              </app-copy-to-clipboard>
              <button class="btn btn-outline-info ms-2" (click)="out = ''; error = false">clear</button>
            </div>

            <div class="border rounded bg-light p-2 overflow-auto mb-2" style="max-height: 30vh">
              <pre [class.text-danger]="error" class="m-0 text-ws-break"><code>{{ out || 'no output' }}</code></pre>
            </div>
          </div>
        </div>
      </div>

      <div class="col-lg-2 col-12 mb-3 ms-0 ps-0">
        <div class="card border-0">
          <div class="card-header bg-secondary text-white">
            <h5 class="mb-0">Bindings</h5>
          </div>
          <div class="card-body">
            <div class="table-responsive">
              <table class="table table-sm mb-0">
                <tbody>
                  <tr *ngFor="let b of bindings">
                    <td>
                      <app-copy-to-clipboard
                        [textToCopy]="b[0]"
                        [label]="b[0]"
                        btnClasses="btn btn-link p-0  text-decoration-none"
                      ></app-copy-to-clipboard>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </ng-container>
</div>

<ng-container *ngIf="todos">
  <div class="card mb-2 border-0">
    <div class="card-header bg-light d-flex justify-content-between align-items-center">
      <h6 class="m-0 fw-semibold text-secondary">Todo List (ctrl+k)</h6>
      <button class="btn btn-sm btn-outline-secondary" (click)="toggleAddMode()">
        <fa-icon [icon]="isAdding ? 'times' : 'plus'"></fa-icon>
      </button>
    </div>

    <!-- New Todo Input -->
    <form
      *ngIf="isAdding"
      [formGroup]="newTodoForm"
      (ngSubmit)="saveNewTodo()"
      class="p-2 border-bottom d-flex justify-content-between align-items-center"
    >
      <input
        type="text"
        appAutoFocus
        class="form-control no-focus me-2"
        formControlName="title"
        placeholder="New todo..."
      />
      <button class="btn btn-link p-0" type="submit" [disabled]="newTodoForm.invalid">
        <fa-icon class="text-primary" icon="save"></fa-icon>
      </button>
    </form>

    <!-- List -->
    <div style="max-height: 49.5vh" class="overflow-auto hidden-scroll" *ngIf="todos.length; else emptyList">
      <ul class="list-group list-group-flush">
        <li *ngFor="let todo of todos" class="list-group-item bg-light-secondary" [class.opacity-50]="todo.done">
          <div class="d-flex justify-content-between align-items-center">
            <span class="fs-5 fw-bold col" [class.text-decoration-line-through]="todo.done">{{ todo.title }}</span>
            <div class="d-inline">
              <button class="btn btn-link p-0 me-1" (click)="toggleDone(todo)">
                <fa-icon
                  [class.text-success]="todo.done"
                  [class.text-muted]="!todo.done"
                  [icon]="['fas', todo.done ? 'check' : 'times']"
                ></fa-icon>
              </button>
              <button class="btn btn-link p-0" (click)="delete(todo)">
                <fa-icon
                  [class.text-success]="todo.done"
                  [class.text-muted]="!todo.done"
                  [icon]="['fas', 'trash']"
                ></fa-icon>
              </button>
            </div>
          </div>
        </li>
      </ul>
    </div>

    <ng-template #emptyList>
      <p class="text-muted text-center mb-0">Nothing to do.</p>
    </ng-template>
  </div>
</ng-container>

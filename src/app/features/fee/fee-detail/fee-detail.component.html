<ng-container *ngIf="fee">
  <div class="modal-header" *ngIf="activeModal">
    <span class="modal-title text-break">
      <fa-icon *ngIf="fee.tag" [icon]="['fas','circle']" [ngClass]="getClassForTag(fee)"></fa-icon>&nbsp;{{fee.subject |
      titlecase}}
    </span>
    <button type="button" class="close" aria-label="Close" (click)="activeModal?.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <form>
      <ul ngbNav #nav="ngbNav" class="nav-tabs">
        <li ngbNavItem>
          <a ngbNavLink>Metadata</a>
          <ng-template ngbNavContent>
            <div class="mt-2">
              <div class="form-group ">
                <label for="feeId">Id</label>
                <input [disabled]="true" type="text" class="form-control" id="feeId" [value]="fee.id">
              </div>
              <div class="form-group ">
                <label for="receivedDate">Date received</label>
                <input [disabled]="true" type="text" class="form-control" id="receivedDate"
                  [value]="fee.date | date:'dd/MM/yyyy HH:mm'">
              </div>
              <div class="form-group ">
                <label for="updatedDate">Updated Date</label>
                <input [disabled]="true" type="text" class="form-control" id="updatedDate"
                  [value]="fee.updatedDate | date:'dd/MM/yyyy HH:mm'">
              </div>
              <div class="form-group " *ngIf="fee.archivedDate">
                <label for="archivedDate">Archived Date</label>
                <input type="text" class="form-control" disabled id="archivedDate"
                  [value]="fee.archivedDate | date:'dd/MM/yyyy HH:mm'">
              </div>
            </div>
          </ng-template>
        </li>
        <li ngbNavItem>
          <a ngbNavLink>Body</a>
          <ng-template ngbNavContent>
            <div class="mt-2">
              <div class="form-group ">
                <label for="body">Body</label>
                <textarea [autosize] [disabled]="true" class="form-control" id="body" [value]="fee.body">
          </textarea>
              </div>
            </div>
          </ng-template>
        </li>
        <li ngbNavItem>
          <a ngbNavLink>Attachments</a>
          <ng-template ngbNavContent>
            <div class="mt-2">
              <div class="bg-light p-2 " *ngIf="!fee.attachmentIds?.length">
                No Content.
              </div>
              <ul class="list-group" id="attachments" *ngIf="fee.attachmentIds.length">
                <li class="list-group-item" *ngFor="let a of fee.attachments">
                  <div class="d-flex justify-content-between">
                    <button class="btn btn-link text-break" (click)="downloadAttachment($event, a)">
                      {{a.metadata.name}}
                    </button>
                    <div class="btn-group">
                      <button class="btn btn-link" [disabled]="fee.attachmentIds.length <= 1 || fee.archived"
                        (click)="removeAttachment($event, a)">
                        <fa-icon [icon]="['fas','times']" class="text-danger"></fa-icon>
                      </button>
                      <button class="btn btn-link" *ngIf="isPdf(a)" (click)="openPdfViewer(a)">
                        <fa-icon [icon]="['fas','file-pdf']" class="text-secondary"></fa-icon>
                      </button>
                      <button class="btn btn-link" *ngIf="isImage(a)" (click)="openImageViewer(a)">
                        <fa-icon [icon]="['fas','file-image']" class="text-secondary"></fa-icon>
                      </button>
                    </div>
                  </div>
                </li>
              </ul>
            </div>
          </ng-template>
        </li>
        <li ngbNavItem>
          <a ngbNavLink>Costs</a>
          <ng-template ngbNavContent>
            <div class="mt-2">
              <app-update-price [fee]="fee" (updatePriceSubmitted)="updatePrice($event)"></app-update-price>
            </div>
          </ng-template>
        </li>
        <li ngbNavItem>
          <a ngbNavLink>Tag</a>
          <ng-template ngbNavContent>
            <div class="mt-2">
              <app-tag-form [hideCancelButton]="true" [selectedTag]="fee.tag" [tags]="tags"
                (tagSubmitted)="updateTag(fee, $event)" [isDisabled]="fee.archived"></app-tag-form>
            </div>
          </ng-template>
        </li>
      </ul>
      <div [ngbNavOutlet]="nav"></div>
    </form>

  </div>
</ng-container>
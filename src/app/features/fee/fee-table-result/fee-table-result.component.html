<ng-container *ngIf="fees">
  <div class="alert alert-danger" *ngIf="!archived && !activeDossier">
    <fa-icon [icon]="['fas','times']"></fa-icon>&nbsp;No active dossier!
  </div>
  <div class="d-md-flex justify-content-between pb-2 pt-1">
    <p>Total Elements: <span class="text-danger">{{fees.totalElements}}</span></p>
    <div *ngIf="!archived" ngbDropdown class="d-inline-block  mt-0" container="body">
      <button class="btn btn-outline-primary" id="dropdownBasic1" ngbDropdownToggle>
        <fa-icon icon="exclamation"></fa-icon>&nbsp;Actions
      </button>
      <div ngbDropdownMenu aria-labelledby="dropdownBasic1">
        <button [disabled]="showTagForm || !selectedRows.length" (click)="showTagForm=!showTagForm" ngbDropdownItem>
          <fa-icon [icon]="['fas','dot-circle']"></fa-icon>&nbsp;Set Tag
        </button>
        <button (click)="openProcessValidation()" [disabled]="showTagForm || !selectedRows.length || !activeDossier"
          ngbDropdownItem>
          <fa-icon [icon]="['fas','cog']"></fa-icon>&nbsp;Process
        </button>
        <button [disabled]="showTagForm || !selectedRows.length" ngbDropdownItem (click)="deleteFees()">
          <fa-icon [icon]="['fas','times']"></fa-icon>&nbsp;Delete
        </button>
        <button ngbDropdownItem (click)="load()">
          <fa-icon [icon]="['fas','sync']"></fa-icon>&nbsp;Reload
        </button>
        <button *ngIf="!archived" [disabled]="showTagForm || selectedRows.length > 0" ngbDropdownItem
          (click)="manualSubmit()">
          <fa-icon [icon]="['fas','upload']"></fa-icon>&nbsp;Manual Submit
        </button>
        <button *ngIf="!archived" [disabled]="showTagForm || selectedRows.length > 0" ngbDropdownItem
          (click)="defaultPrice()">
          <fa-icon [icon]="['fas','dollar-sign']"></fa-icon>&nbsp;Default Prices
        </button>
      </div>

    </div>
  </div>
  <div class="d-block">
    <app-tag-form [tags]="tags" (tagSubmitted)="saveTag($event)" *ngIf="showTagForm && selectedRows.length">
    </app-tag-form>
  </div>
  <div class="d-block pb-2">
    <app-fee-search-form [tags]="tags" [searchCriteria]="searchCriteria" (formSubmitted)="search($event)">
    </app-fee-search-form>
  </div>
  <div class="table-responsive">
    <table class="table table-bordered table-hover">
      <thead>
        <tr>
          <th></th>
          <th>Subject</th>
          <th class="d-md-table-cell d-none">Date received</th>
          <th class="fit">Files</th>
          <th class="text-center" *ngIf="!archived">
            <div class="form-check">
              <input type="checkbox" class="form-check-input position-static" aria-label="select"
                (change)="toggleAllRows($event,fees.content)" [checked]="isAllFeesSelected(fees.content)"
                [disabled]="!fees.content.length">
            </div>
          </th>
        </tr>
      </thead>
      <tbody>
        <tr class="bg-light">
          <td *ngIf="!fees?.content?.length" colspan="5">No entries</td>
        </tr>
        <ng-container *ngFor="let f of fees.content">
          <tr role="button" (click)="openDetail(f)">
            <td>
              <fa-icon [icon]="['fas','circle']" [ngClass]="getClassForTag(f)"></fa-icon>
            </td>
            <td>{{f.subject}}</td>
            <td class="d-md-table-cell d-none">{{f.date | date: 'dd/MM/yyyy HH:mm'}}</td>
            <td class="text-center">
              {{f.attachmentIds.length}}
            </td>
            <td class="text-center" (click)="toggleSelectedRow(f,false, $event)" *ngIf="!archived">
              <div class="form-check">
                <input type="checkbox" class="form-check-input position-static" aria-label="select"
                  [checked]="isFeeSelected(f)">
              </div>
            </td>
          </tr>
        </ng-container>
      </tbody>
      <tfoot>
        <tr class="d-none d-md-table-row bg-light">
          <td colspan="6">
            <ng-container *ngFor="let t of tags">
              <a class="btn btn-link pr-1" (click)="filterByTag(t)">
                <fa-icon [icon]="['fas','circle']" [ngClass]="t.color"></fa-icon>
                <span class="ml-1">{{t.label | lowercase}}</span>
              </a>
          </ng-container>
          </td>
        </tr>
      </tfoot>
    </table>
  </div>
  <div class="d-flex justify-content-between mb-2">
    <ngb-pagination *ngIf="fees && fees.totalPages > 1" [page]="pageNumber" [pageSize]="fees.size" [maxSize]="5"
      [collectionSize]="fees.totalElements" (pageChange)="load($event)">
    </ngb-pagination>
    <select id="pageSize" class="form-control form-control-sm ml-2 col-1 " [(ngModel)]="pageSize"
      *ngIf="fees?.content?.length" (ngModelChange)="load()">
      <option *ngFor="let op of [5,10,20,50,100]" [selected]="op === pageSize">{{op}}</option>
    </select>
  </div>

</ng-container>
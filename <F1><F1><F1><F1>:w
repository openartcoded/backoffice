import { Component, AfterViewInit, OnDestroy, ViewChild, ElementRef, Input, Output, EventEmitter, OnInit } from '@angular/core';
import EasyMDE from 'easymde';

@Component({
    selector: 'app-markdown-editor',
    templateUrl: './markdown-editor.component.html',
    styleUrls: ['./markdown-editor.component.scss'],
    standalone: false,
})
export class MarkdownEditorComponent implements AfterViewInit, OnInit, OnDestroy {
    @Input()
    ngStyle = '';
    ngOnInit(): void {
    }
    @ViewChild('textarea') textarea!: ElementRef<HTMLTextAreaElement>;
    @Input() initialValue: string = '';
    @Output() contentChange = new EventEmitter<string>();

    private easyMDE!: EasyMDE;

    ngAfterViewInit(): void {
        this.easyMDE = new EasyMDE({
            element: this.textarea.nativeElement,
            sideBySideFullscreen: false,
            initialValue: this.initialValue,
            hideIcons: ["fullscreen"]
        });
        this.easyMDE.value(this.initialValue);


    }

    ngOnDestroy(): void {
        this.easyMDE.toTextArea();
        this.easyMDE = null!;
    }

    getValue(): string {
        return this.easyMDE.value();
    }

    setValue(value: string) {
        this.easyMDE.value(value);
    }
}
